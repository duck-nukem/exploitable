<h2>Hello!</h2>

<p>Please log in to become 1337!</p>

<form onsubmit="login(event)">
  <div>
    <label for="username">Username: </label>
    <input title="username" type="text" name="username"/>
  </div>
  <div>
    <label for="password">Password: </label>
    <input title="password" type="password" name="password"/>
  </div>
  <button type="submit">Login</button>
</form>

<div id="result"></div>

<script type="application/javascript">
  function login(event) {
    event.preventDefault();

    var request = createHttpRequest();
    var requestData = prepareRequestData();
    request.send(requestData);

    function writeResultsToPage(xhr) {
      var resultContainer = document.querySelector('#result');
      resultContainer.innerHTML = xhr.responseText;
    }

    function createHttpRequest() {
      var xhr = new XMLHttpRequest();
      xhr.onreadystatechange = function () {
        var DONE = 4; // readyState 4 means the request is done.
        if (xhr.readyState === DONE) {
          writeResultsToPage(xhr);
        }
      };
      xhr.open('POST', '/login');
      xhr.setRequestHeader('Content-Type', 'application/json');
      return xhr;
    }

    function getInputByName(name) {
      return document.querySelector('input[name="' + name + '"]');
    }

    function prepareRequestData() {
      var inputs = ['username', 'password'];
      var data = inputs.reduce(addPropertyWithInputValue, {});
      return JSON.stringify(data);

      function addPropertyWithInputValue(data, inputName) {
        data[inputName] = getInputByName(inputName).value;
        return data;
      }
    }
  }
</script>